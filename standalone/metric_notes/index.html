<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="googlebot" content="noindex">
    <title>Metric notes</title>
    <link rel="stylesheet" href="../../css/fonts.css" />
    <link rel="stylesheet" href="../../css/default.css" />
    <link rel="stylesheet" href="../../css/pygentize.css" />
    <link rel="stylesheet" href="../../css/chao-theorems.css">
    <link rel="stylesheet" href="../../css/sidenotes.css">
    <script defer src="../../css/pangu.simple.js"></script>
    <script>
        // page title
        document.addEventListener("DOMContentLoaded", function () {
            const hostname = window.location.hostname;
            document.title = document.title + " | " + hostname;
        });

        // pangu
        document.addEventListener('DOMContentLoaded', () => {
            pangu.autoSpacingPage();
        });

        // mathjax
        MathJax = {
            options: {
                menuOptions: {
                    settings: {
                        enrich: false,        // true to enable semantic-enrichment
                        collapsible: false,   // true to enable collapsible math
                        speech: false,        // true to enable speech generation
                        braille: false,       // true to enable Braille generation
                        assistiveMml: false,  // true to enable assistive MathML
                    }
                },
                enableMenu: false
            },
            output: {
                font: 'mathjax-fira',
                fontPath: '/mathjax-fira-font'
            },
            tex: {
                macros: {
                    floor: ["{\\left\\lfloor #1 \\right\\rfloor}", 1],
                    ceil: ["{\\left\\lceil #1 \\right\\rceil}", 1],
                    set: ["{\\left\\{ #1 \\right\\}}", 1],
                    norm: ["{\\left\\| #1 \\right\\|}", 1],
                    F: "{\\mathbb F}",
                    R: "{\\mathbb R}",
                    C: "{\\mathbb C}",
                    Z: "{\\mathbb Z}",
                    e: "{\\varepsilon}",
                    mex: "\\mathop{\\operatorname{mex}}",
                    lcm: "\\mathop{\\operatorname{lcm}}",
                    dist: "\\mathop{\\operatorname{dist}}",
                    poly: "\\mathop{\\operatorname{poly}}",
                    polylog: "\\mathop{\\operatorname{polylog}}",
                    span: "\\mathop{\\operatorname{span}}",
                }
            }
        };
    </script>
    <script defer src="../../mathjax/tex-chtml.js"></script>

</head>

<body>
    <div class="navbar-space">
        
        <!-- A table of contents on the left side, but only for screens
                that are big enough -->
        <div id="contents-big">
            <p class="mini-header">Contents <a id="up-arrow" href="#">↑</a></p>
            <ul>
<li><a href="#finite-metric-embeds-into-ell_1">Finite metric embeds into <span class="math inline">\(\ell_1\)</span></a></li>
<li><a href="#largest-finite-metric-xsubset-rnell_22">Largest finite metric <span class="math inline">\((X\subset \R^n,\ell_2^2)\)</span></a></li>
<li><a href="#shortest-path-representation">Shortest path representation</a></li>
<li><a href="#embedding-tree-metric-into-rolog-nell_infty">Embedding tree metric into <span class="math inline">\((\R^{O(\log n)},\ell_\infty)\)</span></a></li>
<li><a href="#kc-outlier-embedding-into-ell_2-chawla_composition_2023"><span class="math inline">\((k,c)\)</span>-outlier embedding into <span class="math inline">\(\ell_2\)</span> <span class="citation" data-cites="chawla_composition_2023">[@chawla_composition_2023]</span></a></li>
</ul>
        </div>
        
    </div>
    <div class="text-space">
        <main role="main">
            <h1 class="pagetitle">Metric notes</h1>
            <article>
                <section class="subtitle">
                    
                    Outlier embedding
                    
                </section>
                <section class="header">
                    Posted on May 26, 2025
                    
                    by Yu Cong
                    
                </section>
                <section>
                    <h1 data-number="1" id="finite-metric-embeds-into-ell_1"><span class="header-section-number">1</span> Finite metric embeds into <span class="math inline">\(\ell_1\)</span></h1>
<p></p>
Bourgain’s theorem states that there exists such an embedding with
distortion <span class="math inline">\(O(\log n)\)</span>. What if we
only want to use tree metrics? It seems that the distortion becomes
<span class="math inline">\(O(\log n \log \log n)\)</span>. <a href="https://chekuri.cs.illinois.edu/papers/packing.pdf" class="uri">https://chekuri.cs.illinois.edu/papers/packing.pdf</a>
<h1 data-number="2" id="largest-finite-metric-xsubset-rnell_22"><span class="header-section-number">2</span> Largest finite metric <span class="math inline">\((X\subset \R^n,\ell_2^2)\)</span></h1>
<p></p>
Arora, Rao and Vazirani made a famous work about approximating uniform
sparsest cut to <span class="math inline">\(O(\sqrt{\log n})\)</span>
via SDP <span class="citation" data-cites="arora_expander_2004">[<a href="#ref-arora_expander_2004" role="doc-biblioref">1</a>]</span>.
Their SDP is finding a finite metric <span class="math inline">\((X,\ell_2^2)\)</span>. An interesting question is
that how large can <span class="math inline">\(X\subset \R^d\)</span> be
given that <span class="math inline">\((X,\ell_2^2)\)</span> is a
metric. Satisfying the triangle inequality is the same as requiring any
three points in <span class="math inline">\(X\)</span> must form a
non-obtuse triangle. One can see that the vertex set in the <span class="math inline">\(n\)</span> dimensional hypercube <span class="math inline">\(Q_n\)</span> is always a feasible solution. The
hard part is the upperbound. I asked this problem on <a href="https://math.stackexchange.com/questions/5066765">math.sx</a> and
found a proof in <em>Proofs from THE BOOK</em> <a href="https://link.springer.com/chapter/10.1007/978-3-662-57265-8_17">chapter
17</a>.
<h1 data-number="3" id="shortest-path-representation"><span class="header-section-number">3</span> Shortest path representation</h1>
<p></p>
For any finite metric on <span class="math inline">\(V\)</span> there is
a corresponding graph shortest path metric on <span class="math inline">\(G=(V,E)\)</span> with <span class="math inline">\(c:E\to \R\)</span>. Given a finite metric on <span class="math inline">\(V\)</span>, how to find <span class="math inline">\(G\)</span> with <span class="math inline">\(|E|\)</span> as small as possible? This looks
similar to <a href="../../posts/minDAG">a previous post in chinese</a>. How
to prove that computing the minimum number of edges is NP-hard?
<p></p>
Consider a simple case that the metric space is 2D Euclidean space. One
can see that the graph for the shortest path representation is a
complete graph if and only if all the points in the 2D plane is in
general position. However, deciding if a set of points in <span class="math inline">\(\mathbb Q\times \mathbb Q\)</span> is NP-complete.
The reduction is from graph independent set. See <a href="../../posts/points_in_general_position">this post</a>.
<h1 data-number="4" id="embedding-tree-metric-into-rolog-nell_infty"><span class="header-section-number">4</span> Embedding tree metric into <span class="math inline">\((\R^{O(\log n)},\ell_\infty)\)</span></h1>
<p></p>
There is an exercise in <a href="https://home.ttic.edu/~harry/teaching/pdf/lecture1.pdf">lecture
notes 1</a> of TTIC CMCS 39600. Show that any <span class="math inline">\(n\)</span> point tree metric <span class="math inline">\((X,d)\)</span> can be embedded isometrically into
<span class="math inline">\((\R^{O(\log n)},\ell_\infty)\)</span>.
<p></p>
Let’s first try the Fréchet embedding <span class="math inline">\(f_{Y}:
X\to \R^{|Y|}\)</span> for some <span class="math inline">\(Y\subset
X\)</span>. Define <span class="math inline">\(f_{Y}(x)=\bigoplus_{y\in
Y} d(x,y)\)</span>, where <span class="math inline">\(\oplus\)</span> is
the direct sum of vector coordinates. Then one has
<p></p>
<span class="math display">\[\begin{equation*}
\begin{aligned}
\|f_Y(u)-f_y(v)\|_\infty    &amp;= \max_{y\in Y} |d(y,u)-d(y,v)|\\
                            &amp;\leq d(u,v).
\end{aligned}
\end{equation*}\]</span>
<p></p>
The subset <span class="math inline">\(Y\)</span> needs to satisfy the
followings,
<ol type="1">
<li><span class="math inline">\(|Y|=O(\log n)\)</span> (dimension
bound)</li>
<li>for each pair of points <span class="math inline">\(u,v\in
X\)</span>, there exists an element <span class="math inline">\(y\in
Y\)</span> such that <span class="math inline">\(d(u,v)=|d(y,u)-d(y,v)|\)</span>. (isometric)</li>
</ol>
<p></p>
It turns out that a hard example is the star <span class="math inline">\(K_{1,n-1}\)</span> with unit edge length. Now
suppose we select any subset <span class="math inline">\(Y\)</span> and
get the embedding <span class="math inline">\(f_Y\)</span>. There must
be at least two degree one vertices (say <span class="math inline">\(u,v\)</span>) not in <span class="math inline">\(Y\)</span> since <span class="math inline">\(Y\ll
n\)</span>. Then we have <span class="math inline">\(|d(y,u)-d(y,v)|=0\)</span> for any <span class="math inline">\(y\)</span>. However, the tree metric shows <span class="math inline">\(d(u,v)=2\)</span>. Thus our Fréchet embedding is
not isometric…
<p></p>
Or is it? We can adjust constraints on the desired point set <span class="math inline">\(Y\)</span> a little bit. Consider the coordinate
for <span class="math inline">\(y\in Y\)</span>. Instead of setting the
value of the <span class="math inline">\(y\)</span>-corrdinate for each
<span class="math inline">\(u\)</span> with <span class="math inline">\(d(u,y)\)</span>, we can make it a function of
<span class="math inline">\(u,y\)</span> and the centroid of the tree.
The condition (2.) is basically asking for a vertex set <span class="math inline">\(Y\)</span> such that for any path <span class="math inline">\(u\sim v\)</span> in the tree there is a vertex
<span class="math inline">\(y\in Y\)</span> such that there is a path
<span class="math inline">\(y\sim u \sim v\)</span> or <span class="math inline">\(u\sim v \sim y\)</span>. (We can see that <span class="math inline">\(|Y|\)</span> is in <span class="math inline">\(O(n)\)</span> via the star example.) This
condition can be changed to finding a path <span class="math inline">\(u\sim y\sim v\)</span>. It is known that for any
tree <span class="math inline">\(T\)</span> with <span class="math inline">\(n\)</span> vertices there is a vertex called
centroid <span class="math inline">\(c_T\)</span> that decomposes the
tree into 2 trees <span class="math inline">\(L,R\)</span> such that,
<ol type="1">
<li><span class="math inline">\(L\cap R=\set{c_T}\)</span>,</li>
<li><span class="math inline">\(L\cup R=T\)</span>,</li>
<li><span class="math inline">\(|L|,|R|\leq \frac{2}{3}n\)</span>.</li>
</ol>
<p></p>
(using <span class="math inline">\(L\)</span> for the set of vertices in
<span class="math inline">\(L\)</span>…)
<p></p>
We maintain a vector for each vertex in the tree metric space. Decompose
the current tree <span class="math inline">\(T\)</span> into two parts
<span class="math inline">\(L\)</span> and <span class="math inline">\(R\)</span> at the centroid <span class="math inline">\(c_T\)</span>. Add a new dimension (the <span class="math inline">\(c_T\)</span>-coordinate) for each vector: For
<span class="math inline">\(u\in L\)</span> the new coordinate is <span class="math inline">\(d(c_T,u)\)</span>; For <span class="math inline">\(u\in R\)</span> the new coordinate is <span class="math inline">\(-d(c_T,u)\)</span>. One can prove by induction
that the resulting vectors with <span class="math inline">\(\ell_\infty\)</span> norm is an isometrically
embedding of the original metric space <span class="math inline">\((X,d)\)</span>. The dimension is the same as the
depth of centroid decomposition, which is clearly <span class="math inline">\(O(\log n)\)</span>.
<p></p>
This method is described in <span class="citation" data-cites="linial_geometry_1995">[<a href="#ref-linial_geometry_1995" role="doc-biblioref">2</a>, Theorem 5.3]</span>.
<h1 data-number="5" id="kc-outlier-embedding-into-ell_2-chawla_composition_2023"><span class="header-section-number">5</span> <span class="math inline">\((k,c)\)</span>-outlier embedding into <span class="math inline">\(\ell_2\)</span> <span class="citation" data-cites="chawla_composition_2023">[<a href="#ref-chawla_composition_2023" role="doc-biblioref">3</a>]</span></h1>
<p></p>
Given two metric space <span class="math inline">\((X,d_X)\)</span> and
<span class="math inline">\((Y,d_Y)\)</span>, <span class="math inline">\((X,d_X)\)</span> is said to have a <span class="math inline">\((k,c)\)</span>-outlier embedding into <span class="math inline">\((Y,d_Y)\)</span> if there is a set <span class="math inline">\(K\subset X\)</span> of size at most <span class="math inline">\(k\)</span> and a mapping <span class="math inline">\(\alpha: X\setminus K \to Y\)</span> with
distortion <span class="math inline">\(\leq c\)</span>. Deciding if
<span class="math inline">\((X,d_X)\)</span> has a <span class="math inline">\((k,c)\)</span>-outlier embedding into <span class="math inline">\((Y,d_Y)\)</span> is NP-Complete for <span class="math inline">\((Y,d_Y)=(\R^n, \ell_p)\)</span>. Authors of <span class="citation" data-cites="chawla_composition_2023">[<a href="#ref-chawla_composition_2023" role="doc-biblioref">3</a>]</span>
provide a polytime algorithm that constructs an <span class="math inline">\((O(k\mathop{\mathrm{polylog}}k),
O(c))\)</span>-outlier embedding into <span class="math inline">\(\ell_2\)</span> (thm 2.9). They noticed the
followings
<ol type="1">
<li>Given a subset <span class="math inline">\(S\subset X\)</span> of
size <span class="math inline">\(|X|-k\)</span> and a partial embedding
<span class="math inline">\(\alpha: S \to Y\)</span> with distortion
<span class="math inline">\(c_S\)</span>, there is a polynomial time
algorithm that finds a weak <span class="math inline">\(125 H_k
c_S\)</span>-nested composition. (thm 2.6, note that the host space can
be any Banach space, thus a weak <span class="math inline">\(125 H_k
c_S\)</span>-nested composition into <span class="math inline">\(\ell_2\)</span>)</li>
<li>One can round a weak <span class="math inline">\(125 H_k
c_S\)</span>-nested composition for an <span class="math inline">\((O(k\mathop{\mathrm{polylog}}k),
O(c))\)</span>-outlier embedding into <span class="math inline">\(\ell_2\)</span> (via rounding a SDP, lemma
3.1)</li>
</ol>
<p></p>
Weak <span class="math inline">\(f(k,c)\)</span>-nested composition is
somewhat stronger than <span class="math inline">\((k,c)\)</span>-outlier embedding since the former
additionally requires an expansion bound on outlier points. In fact I
guess that the definition of weak <span class="math inline">\(f\)</span>-nested composition is extracted from
the SDP formulation of min-outlier.
<p></p>
<span class="math display">\[\begin{equation}
\begin{aligned}
\min&amp;   &amp;   \sum_x \delta_x&amp;    &amp;   &amp;\\
s.t.&amp;   &amp;   (1-\delta_x - \delta_y) d^2(x,y)\leq \|v_x-v_y\|^2
&amp;\leq (c^2+(\delta_x+\delta_y)f(k)) d^2(x,y) &amp;   &amp;\forall
x,y\in X\\
    &amp;   &amp;   \delta_x\in [0,1], v_x&amp;\in
\R^p   &amp;   &amp;\forall x\in X
\end{aligned}
\end{equation}\]</span>
<p></p>
Note that this SDP is <strong>not</strong> a relaxation for <span class="math inline">\((k,c)\)</span>-outlier embedding (finding the
smallest <span class="math inline">\(k\)</span> for fixed <span class="math inline">\(c\)</span>) since the optimal solution may not
satisfy the constraint <span class="math inline">\(\|v_x-v_y\|^2\leq
(c^2+f(k))d^2(x,y)\)</span> for outlier <span class="math inline">\(x\)</span> and non-outlier <span class="math inline">\(y\)</span>. However, (1.) shows that if <span class="math inline">\((X,d)\)</span> admits a <span class="math inline">\((k,c)\)</span>-outlier embedding, then there is a
weak <span class="math inline">\(125 H_k c_S\)</span>-nested
composition, which implies this SDP has a feasible solution with <span class="math inline">\(f(k)=125 H_k c\)</span> and integral <span class="math inline">\(\delta_x\)</span>. Then one can use the rounding
process in (2.) to get a <span class="math inline">\((O(\frac{\log^2
k}{\epsilon}k),(1+\epsilon)c)\)</span>-outlier embedding into <span class="math inline">\(\ell_2\)</span>.
<h1 class="unnumbered" id="bibliography">References</h1>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-arora_expander_2004" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">S.
Arora, S. Rao, U. Vazirani, Expander flows, geometric embeddings and
graph partitioning, in: <em>Proceedings of the Thirty-Sixth Annual
<span>ACM</span> Symposium on <span>Theory</span> of Computing</em>,
Association for Computing Machinery, New York, NY, USA, 2004: pp.
222–231 <a href="https://doi.org/10.1145/1007352.1007355">10.1145/1007352.1007355</a>.</div>
</div>
<div id="ref-linial_geometry_1995" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">N.
Linial, E. London, Y. Rabinovich, The geometry of graphs and some of its
algorithmic applications, <em>Combinatorica</em>. 15 (1995) 215–245 <a href="https://doi.org/10.1007/BF01200757">10.1007/BF01200757</a>.</div>
</div>
<div id="ref-chawla_composition_2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">S.
Chawla, K. Sheridan, Composition of nested embeddings with an
application to outlier removal, in: <em>Proceedings of the 2024
<span>Annual</span> <span>ACM</span>-<span>SIAM</span>
<span>Symposium</span> on <span>Discrete</span>
<span>Algorithms</span></em>, <span>Society for Industrial and Applied
Mathematics</span>, 2023: pp. 1641–1668 <a href="https://doi.org/10.1137/1.9781611977912.66">10.1137/1.9781611977912.66</a>.</div>
</div>
</div>
                </section>
            </article>
        </main>
    </div>
</body>

</html>