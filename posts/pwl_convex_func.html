<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="googlebot" content="noindex">
    <title>Piecewise Linear Convex Functions</title>
    <link rel="preload" href="../fonts/FiraSans-Regular.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="../fonts/FiraSans-Italic.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="../fonts/FiraSans-SemiBold.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="../fonts/IosevkaCustom-Regular.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="stylesheet" href="../css/fonts.css" />
    <link rel="stylesheet" href="../css/default.css" />
    <link rel="stylesheet" href="../css/pygentize.css" />
    <link rel="stylesheet" href="../css/chao-theorems.css">
    <link rel="stylesheet" href="../css/sidenotes.css">
    <script defer src="../css/pangu.simple.js"></script>
    <script>
        // page title
        document.addEventListener("DOMContentLoaded", function () {
            const hostname = window.location.hostname;
            document.title = document.title + " | " + hostname;
        });

        // pangu
        document.addEventListener('DOMContentLoaded', () => {
            pangu.autoSpacingPage();
        });

        // mathjax
        MathJax = {
            options: {
                menuOptions: {
                    settings: {
                        enrich: false,        // true to enable semantic-enrichment
                        collapsible: false,   // true to enable collapsible math
                        speech: false,        // true to enable speech generation
                        braille: false,       // true to enable Braille generation
                        assistiveMml: false,  // true to enable assistive MathML
                    }
                },
                enableMenu: false
            },
            output: {
                font: 'mathjax-fira',
                fontURL: '/mathjax-fira-font'
            },
            tex: {
                macros: {
                    floor: ["{\\left\\lfloor #1 \\right\\rfloor}", 1],
                    ceil: ["{\\left\\lceil #1 \\right\\rceil}", 1],
                    set: ["{\\left\\{ #1 \\right\\}}", 1],
                    norm: ["{\\left\\| #1 \\right\\|}", 1],
                    F: "{\\mathbb F}",
                    R: "{\\mathbb R}",
                    C: "{\\mathbb C}",
                    Z: "{\\mathbb Z}",
                    e: "{\\varepsilon}",
                    mex: "\\mathop{\\operatorname{mex}}",
                    lcm: "\\mathop{\\operatorname{lcm}}",
                    dist: "\\mathop{\\operatorname{dist}}",
                    poly: "\\mathop{\\operatorname{poly}}",
                    polylog: "\\mathop{\\operatorname{polylog}}",
                    span: "\\mathop{\\operatorname{span}}",
                }
            }
        };
    </script>
    <script defer src="../mathjax/tex-chtml.js"></script>

</head>

<body>
    <div class="navbar-space">
        
        <!-- A table of contents on the left side, but only for screens
                that are big enough -->
        <div id="contents-big">
            <p class="mini-header">Contents <a id="up-arrow" href="#">↑</a></p>
            <ul>
<li><a href="#piecewise-linear-function-frdto-r">piecewise linear function <span class="math inline">\(f:\R^d\to \R\)</span></a></li>
<li><a href="#properties">properties</a>
<ul>
<li><a href="#convex-conjugate">convex conjugate</a></li>
<li><a href="#pwl-convex-function-in-r-circ-a-linear-mapping">pwl convex function in <span class="math inline">\(\R\)</span> <span class="math inline">\(\circ\)</span> a linear mapping</a></li>
</ul></li>
<li><a href="#sum-of-pwl-convex-functions">sum of pwl convex functions</a></li>
</ul>
        </div>
        
    </div>
    <div class="text-space">
        <header class="no-print">
            <nav class="navbar">
                <a href="../">Home</a>
                <div class="navright">
                    <a href="../draft.html">Drafts</a>
                    <a href="../about.html">About</a>
                    <!-- <a href="/contact.html">Contact</a> -->
                    <!-- <a href="/archive.html">Archive</a> -->
                    <!-- <a href="/tags.html">Tags</a> -->
                </div>
            </nav>
        </header>

        <main role="main">
            <h1 class="pagetitle">Piecewise Linear Convex Functions</h1>
            <article>
    <section class="subtitle">
        
        
    </section>
    <section class="header">
        Posted on September 16, 2024
        
            by Yu Cong
        
    </section>
    <div class="info">
        
            Tags: <a title="All pages tagged 'alg'." href="../tags/alg.html" rel="tag">alg</a>, <a title="All pages tagged 'optimization'." href="../tags/optimization.html" rel="tag">optimization</a>
        
    </div>    
    <section>
        <p></p>
This post is a note on epigraphs, infimal convolution, Minkowski sum
&amp; convex conjugate of piecewise linear convex functions in <span class="math inline">\(\R^d\)</span>. I want to provide proofs for
relations between these operations and counterexamples for wrong
guesses.
<p></p>
Notions:
<ul>
<li>infimal convolution: <span class="math inline">\(\square\)</span>,</li>
<li>Minkowski sum: <span class="math inline">\(\oplus\)</span>,</li>
<li>convex conjugate: <span class="math inline">\(f^*\)</span>,</li>
<li>epigraph: <span class="math inline">\(\mathop{\mathrm{epi}}f\)</span>.</li>
</ul>
<p></p>
some notes:
<ul>
<li><a href="https://angms.science/doc/CVX/Epigraph.pdf" class="uri">https://angms.science/doc/CVX/Epigraph.pdf</a></li>
<li><a href="https://math.stackexchange.com/questions/1597809/inf-convolution-two-basic-questions" class="uri">https://math.stackexchange.com/questions/1597809/inf-convolution-two-basic-questions</a></li>
</ul>
<h1 data-number="1" id="piecewise-linear-function-frdto-r"><span class="header-section-number">1</span> piecewise linear function <span class="math inline">\(f:\R^d\to \R\)</span></h1>
<p></p>
A intuitive but very complex definition is the following<span class="citation" data-cites="Toriello_Vielma_2012">[<a href="#ref-Toriello_Vielma_2012" role="doc-biblioref">1</a>]</span>,
<div class="theorem-environment Definition" data-index="1" type="Definition">
<span class="theorem-header"><span class="type">Definition</span><span class="index">1</span></span>
<p></p>
Let <span class="math inline">\(\mathcal P\)</span> be a set of bounded
convex polytopes in <span class="math inline">\(\R^d\)</span>. A
piecewise linear function <span class="math inline">\(f\)</span> can be
defined as
<p></p>
<span class="math display">\[
f(x)=c_P^T x+d_P, \text{ for } x\in P,
\]</span> where <span class="math inline">\((c_P,d_P)\in
\R^{d+1}\)</span> is a vector associated with polytope <span class="math inline">\(P\)</span>.
<p></p>
For <em>continuity</em>, we require
<p></p>
<span class="math display">\[
c_P^T x+d_P=c_Q^T x+d_Q, \; \forall x\in P\cap Q, \forall P,Q\in
\mathcal{P}
\]</span>
<p></p>
For <em>convexity</em>, we further require that
<ol type="1">
<li>for any subset <span class="math inline">\(\mathcal{P'}\subset
\mathcal P\)</span>, <span class="math inline">\(\cup_{P\in \mathcal
P'}\)</span> is convex;(for polytopes)</li>
<li>the restriction of <span class="math inline">\(f\)</span> to any two
polytopes from P that share a facet is convex.<span class="citation" data-cites="Tarela_Alonso_Martínez_1990">[<a href="#ref-Tarela_Alonso_Martínez_1990" role="doc-biblioref">2</a>]</span> (for <span class="math inline">\(f\)</span>. In fact, 1 is already included in
2.)</li>
</ol>
</div>
<p></p>
(Later I find a much simpler definition in <span class="citation" data-cites="boyd_convex_2004">[<a href="#ref-boyd_convex_2004" role="doc-biblioref">3</a>]</span> example 3.5.)
<div class="theorem-environment Definition" data-index="2" type="Definition" title="piecewise linear function in $\R^d$">
<span class="theorem-header"><span class="type">Definition</span><span class="index">2</span><span class="name">piecewise linear function in
<span class="math inline">\(\R^d\)</span></span></span>
<p></p>
<span class="math display">\[
f(x)=\max \{a_1^Tx+b_1,\ldots,a_L^Tx+b_L\}
\]</span>
</div>
<p></p>
It is shown in exercise 3.29 that every piecewise linear convex function
can be expressed in this form.
<div class="theorem-environment Proof" type="Proof">
<span class="theorem-header"><span class="type">Proof</span></span>
<p></p>
We have <span class="math inline">\(f(\alpha x+(1-\alpha)y)\leq \alpha
f(x)+(1-\alpha)f(y)\)</span> for any <span class="math inline">\(\alpha\in [0,1]\)</span>. <span class="math inline">\(\alpha x+(1-\alpha)y\)</span> can locate in the
same <span class="math inline">\(X_i\)</span> as <span class="math inline">\(y\)</span> since we can arbitrarily choose <span class="math inline">\(\alpha\)</span>. Thus <span class="math inline">\(f(x)\geq \frac{f(\alpha
x+(1-\alpha)y)-(1-\alpha)f(y)}{\alpha}\)</span>. Note that <span class="math inline">\(f\)</span> is linear in each <span class="math inline">\(X_i\)</span>. Thus <span class="math inline">\(f(x)\geq \frac{a_i^T(\alpha
x+(1-\alpha)y)+b_i-(1-\alpha)(a_i^Ty+b_i)}{\alpha}=a_i^Tx+b_i\)</span>.
Thus <span class="math inline">\(f(x)=\max_i a_i^Tx+b_i\)</span>.
</div>
<p></p>
Now given these definitions we are particularly interested in the
minimum number of polytopes which define the piecewise liner convex
function in high dimension.
<h1 data-number="2" id="properties"><span class="header-section-number">2</span> properties</h1>
<p></p>
pwl = piecewise linear. Let <span class="math inline">\(L\)</span> be
the number of hyperplanes in the definition of <span class="math inline">\(f\)</span>.
<h2 data-number="2.1" id="convex-conjugate"><span class="header-section-number">2.1</span> convex conjugate</h2>
<div class="theorem-environment Observation" data-index="3" type="Observation">
<span class="theorem-header"><span class="type">Observation</span><span class="index">3</span></span>
<p></p>
Let <span class="math inline">\(f^*\)</span> be the convex conjugate of
a pwl convex function <span class="math inline">\(f\)</span>. <span class="math inline">\(f^*\)</span> is also pwl convex if restricted to
<span class="math inline">\(\mathop{\mathrm{dom}}f^*\)</span>.
</div>
<p></p>
Consider the convex conjugate from a geometric view. The epigraph of our
pwl convex function <span class="math inline">\(f\)</span> is some
convex polytope in <span class="math inline">\(\R^d\times
\overline{\R}\)</span>. The convex conjugate is <span class="math inline">\(f^*(z)=\sup_x\{z^Tx-f(x)\}\)</span>. <span class="math inline">\(z^Tx\)</span> is a hyperplane with normal vector
<span class="math inline">\(z\)</span> and passing through the origin.
Now <span class="math inline">\(\sup_x\{z^Tx-f(x)\}\)</span> is the
amount of space hyperplane <span class="math inline">\(z^Tx\)</span> has
to shift along the <span class="math inline">\(d+1\)</span> dimension to
make itself a supporting hyperplane of <span class="math inline">\(\mathop{\mathrm{epi}}f\)</span>. Note that the
tangent points are exactly vertices of <span class="math inline">\(\mathop{\mathrm{epi}}f\)</span>.
<div class="theorem-environment Proof" type="Proof">
<span class="theorem-header"><span class="type">Proof</span></span>
<!-- By definition of pwl convex function in high dimension, we can see that ... No... I think this is dual polyhedron. but it is quite complex -->
<p></p>
It is safe to write <span class="math inline">\(f^*(z)=\max_x\{z^Tx-f(x)\}\)</span> since we only
consider the extended domain. Thus we have <span class="math inline">\(f^*(z)=\max_x\{z^Tx-\max_i\{a_i^Tx+b_i\}\}=\max_x\{\max_i\{z^Tx-a_i^Tx+b_i\}\}\)</span>.
Let <span class="math inline">\(n\)</span> be the number of vertices on
<span class="math inline">\(\mathop{\mathrm{conv}}(\mathop{\mathrm{epi}}f)\)</span>.
One can see that <span class="math inline">\(f^*(z)\)</span> is the
maximum of <span class="math inline">\(O(nL)\)</span> affine functions.
</div>
<p></p>
I believe there will be only <span class="math inline">\(O(n)\)</span>
hyperplanes on <span class="math inline">\(f^*\)</span> instead of <span class="math inline">\(O(nL)\)</span>… However, we know that in general
<span class="math inline">\(f^*\)</span> is the maximum of at least
<span class="math inline">\(O(n)\)</span> functions since every vertex
corresponds to a hyperplane in <span class="math inline">\(\mathop{\mathrm{epi}}f^*\)</span>.
<h2 data-number="2.2" id="pwl-convex-function-in-r-circ-a-linear-mapping"><span class="header-section-number">2.2</span> pwl convex function in <span class="math inline">\(\R\)</span> <span class="math inline">\(\circ\)</span> a linear mapping</h2>
<div class="theorem-environment Problem" data-index="4" type="Problem">
<span class="theorem-header"><span class="type">Problem</span><span class="index">4</span></span>
<p></p>
Let <span class="math inline">\(f:\R^d\to\R\)</span> be a pwl convex
function. Does there always exist a pwl convex <span class="math inline">\(g:\R\to \R\)</span> and a linear mapping <span class="math inline">\(a^Tx-b:\R^d\to \R\)</span> such that <span class="math inline">\(f(x)=g(a^Tx-b)\)</span>.
</div>
<p></p>
As you expected, the answer is no. Let <span class="math inline">\(f:\R^2\to \R\)</span> be the maximum of a set of
2D planes. Consider a series of points <span class="math inline">\(\set{p_1,p_2,...,p_k}\)</span> on the 2D plane.
After applying the linear mapping to <span class="math inline">\(P=\set{p_1,p_2,...,p_k}\)</span>, we will get a
sequence of numbers(points in 1D) <span class="math inline">\(P'=\set{p_1',p_2',...,p_k'}\)</span>.
We assume that <span class="math inline">\(P'\)</span> is
non-decreasing. Note that the value of <span class="math inline">\(g\)</span> on <span class="math inline">\(P'\)</span> is always unimodal since <span class="math inline">\(g\)</span> is convex. However, the value of <span class="math inline">\(f\)</span> on <span class="math inline">\(P\)</span> may not be unimodal. Thus the
composition of a linear mapping and a pwl convex function in 1D is not
equivalent to pwl convex functions in high dimensions.
<h1 data-number="3" id="sum-of-pwl-convex-functions"><span class="header-section-number">3</span> sum of pwl convex functions</h1>
<p></p>
I want to show that in general the number of hyperplanes in the sum of
pwl convex functions can be large.
<p></p>
It is known that for two pwl convex functions <span class="math inline">\(f,g\)</span>, <span class="math inline">\(f^*+g^*=(f\square g)^*\)</span>. It is also known
that <span class="math inline">\(\mathop{\mathrm{epi}}f \oplus
\mathop{\mathrm{epi}}g=\mathop{\mathrm{epi}}f\square g\)</span>(with
some requirements on <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span>). There is a theorem in <span class="citation" data-cites="mountford_minkowski_nodate">[<a href="#ref-mountford_minkowski_nodate" role="doc-biblioref">4</a>]</span> section 4.3 which shows that the
number of faces of the Minkowski sum of two polytopes can be huge. The
bound can be reached by sums of cyclic polytopes.
<p></p>
We can define pwl convex functions based on cyclic polytopes and we know
that the Minkowski sum will have lots of faces(of different dimensions).
We also know that the number of faces in <span class="math inline">\(f^*\)</span> is at least <span class="math inline">\(n\)</span> where <span class="math inline">\(n\)</span> is the number of vertices(faces of 1D)
in <span class="math inline">\(\mathop{\mathrm{epi}}f\)</span>. Now if
the infimal convolution of two pwl convex functions also has many faces,
the number of faces in the sum of pwl convex functions will be large.
<div class="theorem-environment Problem" data-index="5" type="Problem">
<span class="theorem-header"><span class="type">Problem</span><span class="index">5</span></span>
<p></p>
Let <span class="math inline">\(f_1,f_2\)</span> be two pwl convex
functions in <span class="math inline">\(\R^d\)</span>. Let <span class="math inline">\(n_1,n_2\)</span> be the number of hyperplanes in
<span class="math inline">\(f_1,f_2\)</span> respectively. What is the
minimum number of hyperplanes in <span class="math inline">\(f_1 \square
f_2\)</span>?
</div>
<h1 class="unnumbered" id="bibliography">References</h1>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-Toriello_Vielma_2012" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">A.
Toriello, J.P. Vielma, Fitting piecewise linear continuous functions,
<em>European Journal of Operational Research</em>. 219 (2012) 86–95 <a href="https://doi.org/10.1016/j.ejor.2011.12.030">10.1016/j.ejor.2011.12.030</a>.</div>
</div>
<div id="ref-Tarela_Alonso_Martínez_1990" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">J.M. Tarela, E. Alonso, M.V. Martı́nez, A
representation method for PWL functions oriented to parallel processing,
<em>Mathematical and Computer Modelling</em>. 13 (1990) 75–83 <a href="https://doi.org/10.1016/0895-7177(90)90090-a">10.1016/0895-7177(90)90090-a</a>.</div>
</div>
<div id="ref-boyd_convex_2004" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">S.P. Boyd, L. Vandenberghe, Convex
optimization, Cambridge University Press, Cambridge, UK ; New York,
2004.</div>
</div>
<div id="ref-mountford_minkowski_nodate" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">T.
Mountford, T. Liebling, K. Fukuda, P. Gritzmann, G. Ziegler, Minkowski
<span>Sums</span> of <span>Polytopes</span>: <span>Combinatorics</span>
and <span>Computation</span>, PhD thesis, n.d.</div>
</div>
</div>
    </section>
</article>

        </main>

        <footer class="no-print">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>.
            <a href="https://github.com/congyu711/Hakyllsite">Source</a> on Github.
            License <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 </a> <img src="../images/ccbysa.png" alt="Creative Commons License" style="height: 12px; vertical-align: baseline;">

        </footer>
    </div>
</body>

</html>